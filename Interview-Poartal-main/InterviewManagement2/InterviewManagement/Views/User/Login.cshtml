
@{
    Layout = null;
}


<!DOCTYPE html>
<!-- Coding By CodingNepal - www.codingnepalweb.com -->
<html>
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoginForm</title>
    <link href="~/CustomCSS/Login1.css" rel="stylesheet" />
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
</head>

<body>

    <div class="wrapper">

        @if (TempData["Companyerror"] != null)
        {
            <div id="registrationSuccessMessage" class="alert alert-success">
                @TempData["Companyerror"]
            </div>
        }

        <form action="@Url.Action("Login","User")" method="post" id="myForm">
            <h2>Login</h2>
            <div class="input-field">
                <input type="text" name="UserName" required>
                <label>Enter your email/CompanyName/MoNo.</label>
            </div>
            <div class="input-field">
                <input type="password" name="Password" id="passwordField" required>
                <label>Enter your password</label>
            </div>
            <div class="forget">
                <label for="remember">
                    <input type="checkbox" id="showPassword">
                    <p class="fs-6 mt-3">Show</p>
                </label>
                <a href="#">Forgot password?</a>
            </div>
            <button type="submit">LogIn</button>
            <div class="register">
                <p>Don't have an account? <a href="~/User/Registration">Register</a></p>
            </div>
        </form>
    </div>

    <script src="~/Scripts/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#myForm').submit(function (event) {
                // Prevent the default form submission
                event.preventDefault();

                // Create FormData object to handle the form data, including files
                var formData = new FormData(this);

                $.ajax({
                    url: '/User/Login',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        if (response.success) {
                            // Redirect to another page if needed
                            alert(response.message);
                            window.location.href = '/Home/Index';
                        } else {
                            // Show error messages on the Login page using an alert
                            alert(response.message);
                            window.location.href = '/User/Login';
                        }
                    },
                    error: function (xhr, status, error) {
                        // Handle AJAX error
                        var errorMessage = xhr.responseText;
                        alert('An error occurred during the AJAX request: ' + errorMessage);
                    }
                });
            });
        });
    </script>

    <script>
        // Automatically hide the success message after 5 seconds (adjust as needed)
        setTimeout(function () {
            $('#registrationSuccessMessage').fadeOut('slow');
        }, 3000); // 3000 milliseconds = 3 seconds
    </script>

</body>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var passwordField = document.getElementById('passwordField');
        var showPasswordCheckbox = document.getElementById('showPassword');

        showPasswordCheckbox.addEventListener('change', function () {
            passwordField.type = showPasswordCheckbox.checked ? 'text' : 'password';
        });
    });
</script>
</html>